--[[
	cLinux : Lore of the Day!
	Made by Piorjade, daelvn

	NAME:        /boot/load
	CATEGORY:    boot
	SET:         Boot II
	VERSION:     01:alpha0
	DESCRIPTION: 
		This script is ran after /boot/clinux.i
		and loads important libraries up
		and starts the shell at the end.
]]--

--if flag.STATE_INIT ~= true or flag.STATE_INIT == nil then
--end

if _G['flag'] and _G['flag']['STATE_INIT'] then
	for _, a in ipairs(fs.list("/lib/")) do
		print("Loading "..a)
		local ok, err = loadAPI("/lib/"..a)
		if ok == false then
			local c = term.getTextColor()
			term.setTextColor(colors.red)
			print("["..a.."] "..tostring(err))
			term.setTextColor(c)
			flag.STATE_DEAD = true
		else
			local c = term.getTextColor()
			term.setTextColor(colors.green)
			term.write("[OK]")
			term.setTextColor(c)
			print(" "..a.." loaded!")
			sleep(0.5)
		end
	end
	local xBox = {}

	for _, a in pairs(_G) do
		xBox[_] = a
	end
	local x, err = thread.new("/bin/shell.lua", 1)
	if x == false then
		cLinuxPrintError("X", err)
		sleep(2)
	end
	thread.runAll(x.next)
	flag.STATE_DEAD = true
else
	term.clear(1,1)
	term.setCursorPos(1,1)
	printError("cLinux not initialized, boot cLinux.i")
end
